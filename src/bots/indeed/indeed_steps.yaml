workflow_meta:
  title: "Indeed Job Search"
  description: "Search and apply to jobs on Indeed with Camoufox browser and overlay"
  start_step: "init_context"

steps_config:
  init_context:
    step: 0
    func: "step0"
    transitions:
      ctx_ready: "open_homepage"
      ctx_failed: "init_context"
    timeout: 30
    on_timeout_event: "ctx_failed"

  open_homepage:
    step: 1
    func: "openHomepage"
    transitions:
      homepage_opened: "detect_page_state"
      homepage_failed: "open_homepage"
    timeout: 45
    on_timeout_event: "homepage_failed"

  detect_page_state:
    step: 2
    func: "detectPageState"
    transitions:
      logged_in: "collect_job_cards"
      sign_in_required: "show_sign_in_overlay"
      page_state_failed: "detect_page_state"
    timeout: 20
    on_timeout_event: "page_state_failed"

  show_sign_in_overlay:
    step: 3
    func: "showSignInOverlay"
    transitions:
      signin_complete: "collect_job_cards"
      overlay_failed: "detect_page_state"
    timeout: 600
    on_timeout_event: "overlay_failed"

  collect_job_cards:
    step: 4
    func: "collectJobCards"
    transitions:
      cards_collected: "click_job_card"
      no_cards_found: "done"
      cards_collect_failed: "collect_job_cards"
    timeout: 30
    on_timeout_event: "cards_collect_failed"

  click_job_card:
    step: 5
    func: "clickJobCard"
    transitions:
      card_clicked: "click_job_card"
      card_skipped: "click_job_card"
      cards_finished: "done"
      click_failed: "done"
    timeout: 15
    on_timeout_event: "card_skipped"

  done:
    step: 99
    func: "step0"
    transitions:
      done: "done"
    timeout: 1
    on_timeout_event: "done"
