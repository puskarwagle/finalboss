workflow_meta:
  title: "LinkedIn Jobs"
  description: "Search and apply on LinkedIn Jobs with Easy Apply"
  start_step: "step0"

steps_config:
  step0:
    step: 0
    func: "loadAppliedJobIds"
    transitions:
      applied_job_ids_loaded: "open_check_login"
      retry: "open_check_login"
    timeout: 10
    on_timeout_event: "retry"

  open_check_login:
    step: 1
    func: "openCheckLogin"
    transitions:
      login_not_needed: "open_jobs_page"
      user_needs_to_login: "credential_login"
      cannot_determine_login_status: "open_jobs_page"
      no_available_page: "open_check_login"
      failed_to_navigate: "open_check_login"
      failed_checking_login_status: "open_check_login"
    timeout: 30
    on_timeout_event: "failed_to_navigate"

  credential_login:
    step: 2
    func: "credentialLogin"
    transitions:
      login_successful_on_feed: "open_jobs_page"
      on_feed_login_successful: "open_jobs_page"
      no_login_credentials_found: "show_manual_login_prompt"
      credentials_login_incomplete: "show_manual_login_prompt"
      no_available_page: "open_check_login"
      username_input_not_found: "show_manual_login_prompt"
      password_input_not_found: "show_manual_login_prompt"
      signin_button_click_failed: "show_manual_login_prompt"
      wait_for_redirect_timeout: "show_manual_login_prompt"
      credential_login_failed: "show_manual_login_prompt"
    timeout: 40
    on_timeout_event: "credential_login_failed"

  show_manual_login_prompt:
    step: 4
    func: "showManualLoginPrompt"
    transitions:
      prompt_displayed_to_user: "open_check_login"
      error_showing_manual_login: "open_check_login"
    timeout: 20
    on_timeout_event: "prompt_displayed_to_user"

  open_jobs_page:
    step: 5
    func: "openJobsPage"
    transitions:
      jobs_page_loaded: "set_search_location"
      failed_opening_jobs_page: "open_jobs_page"
    timeout: 30
    on_timeout_event: "failed_opening_jobs_page"

  set_search_location:
    step: 6
    func: "setSearchLocation"
    transitions:
      search_location_set: "set_search_keywords"
      no_search_location_in_settings: "set_search_keywords"
      location_input_not_found: "set_search_location"
      failed_setting_search_location: "set_search_location"
      jobs_page_missing: "set_search_location"
    timeout: 30
    on_timeout_event: "failed_setting_search_location"

  set_search_keywords:
    step: 7
    func: "setSearchKeywords"
    transitions:
      search_keywords_set: "apply_filters"
      no_keywords_in_settings: "apply_filters"
      keywords_input_not_found: "set_search_keywords"
      failed_setting_search_keywords: "set_search_keywords"
      jobs_page_missing: "set_search_keywords"
    timeout: 30
    on_timeout_event: "failed_setting_search_keywords"

  apply_filters:
    step: 8
    func: "applyFilters"
    transitions:
      filters_applied_successfully: "get_page_info"
      filters_application_failed: "get_page_info"
      jobs_page_missing: "apply_filters"
    timeout: 40
    on_timeout_event: "filters_application_failed"

  get_page_info:
    step: 9
    func: "getPageInfo"
    transitions:
      page_info_extracted: "extract_job_details"
      pagination_not_found: "extract_job_details"
      failed_extracting_page_info: "get_page_info"
      jobs_page_missing: "get_page_info"
    timeout: 20
    on_timeout_event: "failed_extracting_page_info"

  extract_job_details:
    step: 10
    func: "extractJobDetails"
    transitions:
      proceed_to_process_jobs: "process_jobs"
      no_jobs_page_found: "open_jobs_page"
      no_job_cards_found: "navigate_to_next_page"
      failed_extracting_jobs: "extract_job_details"
    timeout: 60
    on_timeout_event: "failed_extracting_jobs"

  process_jobs:
    step: 11
    func: "processJobs"
    transitions:
      starting_to_process_jobs: "attempt_easy_apply"
      no_jobs_to_process: "finish"
      error_processing_jobs: "finish"
    timeout: 10
    on_timeout_event: "error_processing_jobs"

  attempt_easy_apply:
    step: 14
    func: "attemptEasyApply"
    transitions:
      proceeding_to_resume_upload: "upload_resume"
      attempting_external_apply: "external_apply"
      no_jobs_page_found: "open_jobs_page"
      no_job_to_process: "continue_processing"
      job_card_not_found: "continue_processing"
      no_easy_apply_button_found: "external_apply"
      failed_to_click_easy_apply: "external_apply"
      easy_apply_process_error: "continue_processing"
    timeout: 30
    on_timeout_event: "easy_apply_process_error"

  upload_resume:
    step: 15
    func: "uploadResume"
    transitions:
      resume_uploaded_successfully: "answer_questions"
      no_resume_path_configured: "answer_questions"
      resume_file_not_found: "answer_questions"
      proceeding_without_resume: "answer_questions"
      jobs_page_missing: "upload_resume"
    timeout: 30
    on_timeout_event: "proceeding_without_resume"

  answer_questions:
    step: 16
    func: "answerQuestions"
    transitions:
      finished_answering_questions: "submit_application"
      error_answering_questions: "answer_questions"
      jobs_page_missing: "answer_questions"
    timeout: 60
    on_timeout_event: "error_answering_questions"

  submit_application:
    step: 17
    func: "submitApplication"
    transitions:
      save_applied_job: "save_applied_job"
      application_failed: "application_failed"
      submit_application_error: "submit_application"
      no_jobs_page_found: "submit_application"
    timeout: 30
    on_timeout_event: "submit_application_error"

  save_applied_job:
    step: 18
    func: "saveAppliedJob"
    transitions:
      job_saved: "continue_processing"
      save_job_failed: "save_applied_job"
    timeout: 20
    on_timeout_event: "save_job_failed"

  external_apply:
    step: 19
    func: "externalApply"
    transitions:
      save_external_job: "save_external_job"
      application_failed: "application_failed"
      jobs_page_missing: "external_apply"
    timeout: 30
    on_timeout_event: "application_failed"

  save_external_job:
    step: 20
    func: "saveExternalJob"
    transitions:
      external_job_saved: "continue_processing"
      save_external_failed: "save_external_job"
    timeout: 20
    on_timeout_event: "save_external_failed"

  application_failed:
    step: 21
    func: "applicationFailed"
    transitions:
      application_marked_failed: "continue_processing"
      mark_failed_error: "application_failed"
    timeout: 20
    on_timeout_event: "mark_failed_error"

  continue_processing:
    step: 22
    func: "continueProcessing"
    transitions:
      starting_next_application: "attempt_easy_apply"
      navigate_to_next_page: "navigate_to_next_page"
      continue_processing_error: "finish"
      finish: "finish"
    timeout: 10
    on_timeout_event: "continue_processing_error"

  navigate_to_next_page:
    step: 23
    func: "navigateToNextPage"
    transitions:
      extract_job_details: "extract_job_details"
      finish: "finish"
    timeout: 30
    on_timeout_event: "finish"

  finish:
    step: 24
    func: "finish"
    transitions:
      done: "done"
    timeout: 10
    on_timeout_event: "done"
